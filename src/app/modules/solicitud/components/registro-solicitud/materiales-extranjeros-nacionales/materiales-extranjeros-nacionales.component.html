<div class="p-grid" style="padding-top:20px;">
    <div class="p-col-12">
        <p-message severity="info" text="Corresponde a 
        las materias primas, productos intermedios, partes y piezas de fabricación 
        extranjera, utilizados en la elaboración del producto, ya sean importados 
        directamente por el fabricante o adquiridos en el mercado nacional importados 
        directamente por el proveedor.">
        </p-message>
    </div>
</div>

<div class="table">
    <div class="title">
        <div class="sub-title">
            <button style="margin-right: 20px;" (click)="agregarInsumo()">
                AGREGAR INSUMOS
            </button>
            <span class="spacer"></span>
            <div class="input-group">
                <input placeholder="Buscar" type="text" [(ngModel)]="busqueda" (ngModelChange)="onBuscar()" />
                <mat-icon svgIcon="buscar-circular-negativo"></mat-icon>
            </div>
        </div>
    </div>

    <p-table [value]="materiales" [customSort]="true" [lazy]="true" (onLazyLoad)="onSort($event)">
        <ng-template pTemplate="header">
            <tr>
                <th *ngFor="let columna of columnas" [pSortableColumn]="columna.pSortableColumn">
                    <span class="headline-m --dark-primary-color">
                        {{columna.titulo}}<p-sortIcon *ngIf="columna.sortField!=''" [field]="columna.sortField">
                        </p-sortIcon>
                    </span>
                </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-material let-index="rowIndex">
            <tr>
                <td>
                    <p class="body-uno">{{material['nombreTecnico']}}</p>
                </td>
                <td>
                    <p class="body-uno">{{material['subpartida']}}</p>
                </td>
                <td>
                    <p class="body-uno">{{material['paisOrigen']}}</p>
                </td>
                <td>
                    <p class="body-uno">{{material['paisProcedencia']}}</p>
                </td>
                <td>
                    <p class="body-uno">{{material['unidadMedida']}}</p>
                </td>
                <td>
                    <p class="body-uno">{{material['cantidad']}}</p>
                </td>
                <td>
                    <p class="body-uno">{{material['valorCif']}}</p>
                </td>
                <td>
                    <p class="body-uno">{{material['valorPlanta']}}</p>
                </td>
                <td class="center">
                    <mat-icon svgIcon="editar-positivo" (click)="mostrarFormaEdicion(material)"></mat-icon>
                </td>
                <td class="center">
                    <mat-icon svgIcon="papelera-positivo" (click)="eliminarMaterial(material, index)"></mat-icon>
                </td>
            </tr>
        </ng-template>
    </p-table>
    <div *ngIf="materiales.length==0">
        <p class="content body-uno">No se encontraron registros coincidentes</p>
    </div>
</div>

<div class="button-group">
    <span class="spacer"></span>
    <button class="outlined" style="margin-right: 20px;" [disabled]="materiales.length==0" (click)="exportarExcel()">
        IMPORTAR TODOS LOS REGISTROS
    </button>
    <button class="outlined" [disabled]="materiales.length==0" (click)="abrirEliminarConfirmacion(eliminarTemplate)">
        ELIMINAR TODOS LOS REGISTROS
    </button>
</div>

<h2 class="headline-s">Cargue masivo de materiales extranjeros</h2>
<hr />

<ng-template #eliminarTemplate let-solicitud>
    <div class="modal warning">
        <div>
            <mat-icon svgIcon="informacion-circular-negativo"></mat-icon>
            <p class="body-uno">¿Seguro que desea eliminar todos los registros de la tabla Materiales Extrangeros?</p>
        </div>
        <div>
            <button class="outlined" (click)="dialogRef.close()">CANCELAR</button>
            <button (click)="onEliminarTodos(); dialogRef.close()">CONTINUAR</button>
        </div>
    </div>
</ng-template>